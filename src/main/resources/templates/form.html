<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Getting Started: Handling Form Submission</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script
            src="http://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous">
    </script>
</head>
<body>
<h1>Form</h1>
<form action="#" th:action="@{/generateRandomSetup}" th:object="${setupForm}" method="post">
    <br/>
    Number of Players
    <input class="players" type="number" name="Players" min="1" max="5" value="1" />
    <br/>
    <br/>
    <input class="cardSet" th:field="*{Legendary}" type="checkbox" name="Legendary" value="Legendary" /> Legendary
    <input class="cardSet" th:field="*{DarkCity}" type="checkbox" name="Dark City" value="Dark City" /> Dark City
    <input class="cardSet" th:field="*{FantasticFour}" type="checkbox" name="Fantastic Four" value="Fantastic Four" /> Fantastic Four
    <br/>
    <br/>
    <input type="submit" value="Go!"/>
    <input type="reset" value="Reset"/>
    <div class="randomSetup">
        <p class="scheme"></p>
        <p class="mastermind"></p>
        <ul class="villains"></ul>
        <ul class="heroes"></ul>
    </div>
</form>
</body>
</html>
<script>
    $("form").submit(function(event) {
        var players = 1;
        var cardSets = []

        event.preventDefault()

        console.log($(".players").get(0).value)

        players = $(".players").get(0).value

        $(".cardSet").each(function(index) {
            if (this.checked) {
                cardSets.push(this.value)
                console.log(this.value)
            }
        })

        console.log(players)
        console.log(cardSets)

        $.ajax({
            contentType: "application/json",
            method: "POST",
            url: "/setup?players=" + players,
            data: JSON.stringify(cardSets)
        }).done(function(response) {
            var scheme = response.scheme
            var mastermind = response.mastermind
            var villains = response.villainGroups
            var heroes = response.heroes

            console.log(scheme.name)
            console.log(mastermind.name)

            villains.forEach(function(villainGroup) {
                console.log(villainGroup.name)
            })

            heroes.forEach(function(hero) {
                console.log(hero.name)
                $(".heroes").append("<li>" + hero.name + "</li>")
            })
        })
    });
</script>
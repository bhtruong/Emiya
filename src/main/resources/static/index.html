<!DOCTYPE HTML>
<html>
<head>
    <title>Emiya</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="main.css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <script
            src="http://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous">
    </script>
</head>
<body>
<div class="center">
    <h1>Emiya</h1>
    <form action="#">
        <br/>
        Number of Players
        <input class="players" type="number" name="Players" min="1" max="5" value="1" />
        <br/>
        <br/>
        <input class="cardSet" type="checkbox" name="Legendary" value="Legendary" /> Legendary
        <input class="cardSet" type="checkbox" name="Dark City" value="Dark City" /> Dark City
        <input class="cardSet" type="checkbox" name="Fantastic Four" value="Fantastic Four" /> Fantastic Four
        <br/>
        <br/>
        <input type="submit" value="Go!"/>
        <input type="reset" value="Reset"/>
        <div class="randomSetup">
            <p class="scheme"></p>
            <p class="mastermind"></p>
            <ul class="villains"></ul>
            <ul class="heroes"></ul>
        </div>
    </form>
</div>
</body>
</html>
<script>
    $("form").submit(function(event) {
        var players = 1;
        var cardSets = []

        event.preventDefault()

        console.log($(".players").get(0).value)

        players = $(".players").get(0).value

        $(".cardSet").each(function(index) {
            if (this.checked) {
                cardSets.push(this.value)
                console.log(this.value)
            }
        })

        console.log(players)
        console.log(cardSets)

        $.ajax({
            contentType: "application/json",
            method: "POST",
            url: "/api/randomSetup?players=" + players,
            data: JSON.stringify(cardSets)
        }).done(function(response) {
            var scheme = response.scheme
            var mastermind = response.mastermind
            var villains = response.villainGroups
            var heroes = response.heroes

            $(".scheme").empty()
            $(".mastermind").empty()
            $(".villains").empty()
            $(".heroes").empty()

            console.log(scheme.name)
            $(".scheme").text(scheme.name)

            console.log(mastermind.name)
            $(".mastermind").text(mastermind.name)

            villains.forEach(function(villainGroup) {
                console.log(villainGroup.name)
                $(".villains").append("<li>" + villainGroup.name + "</li>")
            })

            heroes.forEach(function(hero) {
                console.log(hero.name)
                $("<li>" + hero.name + "</li>").addClass("hero").appendTo(".heroes")
            })
        })
    });
</script>